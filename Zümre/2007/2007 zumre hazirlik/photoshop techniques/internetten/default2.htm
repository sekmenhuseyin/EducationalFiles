<HTML><HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<TITLE>332199 - Using the DCPROMO /FORCEREMOVAL Command to Force the Demotion of Active Directory Domain Controllers</TITLE>
<!-- (c) 2001, 2002 Microsoft Corporation. All Rights Reserved -->
<!-- CPMSFTWBSUP12 ASM: GSS, Version=3.7.4.0, Culture=neutral, PublicKeyToken=null FW: 1.1.4322.573 -->
<!-- REGC: ISO-8859-1 DEFRC: utf-8 RESG: 2/23/2004 8:42:47 AM RESX: 1/1/0001 12:00:00 AM -->
<META NAME="Keywords" CONTENT="kbbug KB332199  kbwin2000AdvServ kbwin2000AdvServSearch kbwin2000DataServ kbwin2000DataServSearch kbwin2000Search kbwin2000Serv kbwin2000ServSearch kbWinAdvServSearch kbWinDataServSearch kbWinServ2003Data kbWinServ2003Data64bit kbWinServ2003Data64bitSearch kbWinServ2003DataSearch kbWinServ2003Ent kbWinServ2003Ent64bit kbWinServ2003Ent64bitSearch kbWinServ2003EntSearch kbWinServ2003Search kbWinServ2003St " />
<META NAME="Description" CONTENT="Microsoft Windows 2000 or Microsoft Windows Server 2003 domain controllers may not gracefully demote by using the Active Directory Installation Wizard (Dcpromo.exe)." />
<META NAME="MS.LOCALE" CONTENT="EN" />
<script language="Javascript" SRC="/common/script/gsfx/common.js"></script><link rel='stylesheet' type='text/css' href='/common/css/GN/EN-US/down-other/default.css' ></link><script src="/common/script/gsfx/searchui.js"></script><link rel='stylesheet' type='text/css' href='/common/css/GN/EN-US/down-other/SearchUI.css' ></link><link rel='stylesheet' type='text/css' href='/common/css/GN/EN-US/down-other/webparts.css' ></link><link rel='stylesheet' type='text/css' href='/common/css/GN/EN-US/down-other/KBArticleV2.css' ></link></HEAD>

<BODY bgcolor="#FFFFFF" leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" onLoad="thisLoad();" onUnload="thisUnload();">
<table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%"><tr><td>
<TABLE width="100%" cellspacing="0" cellpadding="0" border="0" HSPACE="0" VSPACE="0"><TR><TD><A HREF="/isapi/gomscom.asp?target=/" TARGET="_top" ><IMG SRC="/library/images/support/bnr_microsoft.gif" 	HEIGHT="60" HSPACE="0" VSPACE="0" ALIGN="LEFT" ALT="Microsoft.com Home Page" BORDER="0" /></A></TD><TD width="100%" ><TABLE WIDTH="100%" CELLPADDING="0" CELLSPACING="0" BORDER="0" HSPACE="0" VSPACE="0"><TR><TD BGCOLOR="#0a6cce" VALIGN="TOP" HEIGHT="20" ALIGN="RIGHT" WIDTH="100%">
<TABLE HEIGHT="20" BORDER="0"CELLPADDING="0" CELLSPACING="0" >
<TR><TD><IMG SRC="/library/images/toolbar/images/curveLTR.gif" WIDTH="18" HEIGHT="20" HSPACE="0" VSPACE="0" ALT="" BORDER="0" /></TD><TD BGCOLOR="#000000" HEIGHT="20" NOWRAP>&nbsp;
<a href="http://www.microsoft.com/products/info/default.aspx?view=22" STYLE="color:#FFFFFF;text-decoration:none;" TARGET="_top"><FONT COLOR="#FFFFFF" style="font-family:Verdana,Arial; font-size: 10px;"> All Products</FONT></a>
</TD><TD BGCOLOR="#000000" HEIGHT="20" NOWRAP><font COLOR="#FFFFFF" style="font-family:Verdana,Arial; font-size: 10px;">&nbsp;|&nbsp;</font></TD><TD BGCOLOR="#000000" HEIGHT="20" NOWRAP>
<a href="http://support.microsoft.com" STYLE="color:#FFFFFF;text-decoration:none;" TARGET="_top"><FONT COLOR="#FFFFFF" style="font-family:Verdana,Arial; font-size: 10px;"> Support</FONT></a>
</TD><TD BGCOLOR="#000000" HEIGHT="20" NOWRAP><font COLOR="#FFFFFF" style="font-family:Verdana,Arial; font-size: 10px;">&nbsp;|&nbsp;</font></TD><TD BGCOLOR="#000000" HEIGHT="20" NOWRAP>
<a href="/isapi/gosearch.asp?target=/us/default.asp" STYLE="color:#FFFFFF;text-decoration:none;" TARGET="_top"><FONT COLOR="#FFFFFF" style="font-family:Verdana,Arial; font-size: 10px;"> Search</FONT></a>
</TD><TD BGCOLOR="#000000" HEIGHT="20" NOWRAP><font COLOR="#FFFFFF" style="font-family:Verdana,Arial; font-size: 10px;">&nbsp;|&nbsp;</font></TD><TD BGCOLOR="#000000" HEIGHT="20" NOWRAP>
<a href="/isapi/gomscom.asp?target=/" STYLE="color:#FFFFFF;text-decoration:none;" TARGET="_top"><FONT COLOR="#FFFFFF" style="font-family:Verdana,Arial; font-size: 10px;"> Microsoft.com Guide</FONT></a>
</TD></TR></TABLE>
</TD></TR><TR><TD BGCOLOR=#0a6cce HEIGHT="40" align="right"><a href="/common/international.aspx" TARGET="_top"><IMG SRC="/library/images/support/EN-US/region_graphic.gif" ALT="International Support" HEIGHT="40" BORDER="0" HSPACE="0" VSPACE="0" /></A></TD></TR></TABLE>
</TD></TR></TABLE>
</td></tr><tr><td class="tpl_top_banner" valign="top"><table class="bbar_outer" border="0" cellpadding="0" cellspacing="0" height="18"><tr>
<td nowrap class="bbar_cell" onmouseover="this.className='bbar_cell_hot';" onmouseout="this.className='bbar_cell';" onClick="top.location.href='http://support.microsoft.com/'"><a target ="_top" href='http://support.microsoft.com/' title='Return to Support Home Page' onclick='event.cancelBubble=true;'>&nbsp;&nbsp;Home&nbsp;&nbsp;</a></td><td class='bannerborder' width=1><img src='/library/images/support/1ptrans.gif' height=1 width=1></td>
<td nowrap class="bbar_cell" onmouseover="this.className='bbar_cell_hot';" onmouseout="this.className='bbar_cell';" onClick="top.location.href='http://support.microsoft.com/default.aspx?pr=kbhowto'"><a target ="_top" href='http://support.microsoft.com/default.aspx?pr=kbhowto' title='Search the Knowledge Base' onclick='event.cancelBubble=true;'>&nbsp;&nbsp;Search&nbsp;&nbsp;</a></td><td class='bannerborder' width=1><img src='/library/images/support/1ptrans.gif' height=1 width=1></td>
<td nowrap class="bbar_cell" onmouseover="this.className='bbar_cell_hot';" onmouseout="this.className='bbar_cell';" onClick="top.location.href='http://support.microsoft.com/default.aspx?pr=faqs'"><a target ="_top" href='http://support.microsoft.com/default.aspx?pr=faqs' title='Frequently Asked Questions and Product Support Centers' onclick='event.cancelBubble=true;'>&nbsp;&nbsp;FAQs&nbsp;&nbsp;</a></td><td class='bannerborder' width=1><img src='/library/images/support/1ptrans.gif' height=1 width=1></td>
<td nowrap class="bbar_cell" onmouseover="this.className='bbar_cell_hot';" onmouseout="this.className='bbar_cell';" onClick="top.location.href='http://support.microsoft.com/default.aspx?pr=downloadover&style=home'"><a target ="_top" href='http://support.microsoft.com/default.aspx?pr=downloadover&style=home' title='Software Downloads, Updates, and Service Packs' onclick='event.cancelBubble=true;'>&nbsp;&nbsp;Downloads&nbsp;&nbsp;</a></td><td class='bannerborder' width=1><img src='/library/images/support/1ptrans.gif' height=1 width=1></td>
<td nowrap class="bbar_cell" onmouseover="this.className='bbar_cell_hot';" onmouseout="this.className='bbar_cell';" onClick="top.location.href='http://support.microsoft.com/newsgroups/default.aspx'"><a target ="_top" href='http://support.microsoft.com/newsgroups/default.aspx' title='Community Newsgroups' onclick='event.cancelBubble=true;'>&nbsp;&nbsp;Newsgroups&nbsp;&nbsp;</a></td><td class='bannerborder' width=1><img src='/library/images/support/1ptrans.gif' height=1 width=1></td>
<td nowrap class="bbar_cell" onmouseover="this.className='bbar_cell_hot';" onmouseout="this.className='bbar_cell';" onClick="top.location.href='http://support.microsoft.com/default.aspx?pr=csshome'"><a target ="_top" href='http://support.microsoft.com/default.aspx?pr=csshome' title='Customer Service' onclick='event.cancelBubble=true;'>&nbsp;&nbsp;Customer Service&nbsp;&nbsp;</a></td><td class='bannerborder' width=1><img src='/library/images/support/1ptrans.gif' height=1 width=1></td>
</tr></table></td></tr><tr><td valign="top" height="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%"><tr><td valign="top"><table cellpadding="0" cellspacing="0" class="tpl_content_bar" width="100%"><tr><td class="tpl_content_title" valign="top" align="left">
							Microsoft Knowledge Base Article - 332199
						</td><td class="subBannerGif" valign="top" align="right">
							<IMG src="/common/resources/Content_subban.gif" border="0" vspace="0" title="332199 - Using the DCPROMO /FORCEREMOVAL Command to Force the Demotion of Active Directory Domain Controllers" />
						</td></tr></table></td></tr><tr><td width="100%" valign="top"><XMLREADER><DIV class="OldIE">
<DIV ID="LTRContent" class="LTRContent" DIR="LTR">
<div class="KBPUBV2" name="KBPUBV2"><!-- - - - - - - - - - - PAGE TEXT BEGINS HERE : KBPUBV2 - - - - - - - - - - --><div class="kbContainer"><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td valign="top" width="100%"><table class="kbRightNav"><tr><td valign="top"><table class="GetHelpVert" width="165"><tr><td valign="middle"><a href="http://support.microsoft.com/default.aspx?scid=sz;EN-US;top&product=winsvr2003&prname=Windows%20Server%202003"><IMG src="http://support.microsoft.com/library/images/support/Get_Help_sml.gif" align="center" border="0" vspace="3" hspace="0" alt="Need More Help?" title="Need More Help?" /></a></td><td><table><tr><td align="center" class="GetHelpTitle" valign="top">Need More Help?</td></tr><tr><td align="center" valign="middle" class="GetHelpText"><a href="http://support.microsoft.com/default.aspx?scid=sz;EN-US;top&product=winsvr2003&prname=Windows%20Server%202003">Contact a Support Professional by E-Mail, Online or Phone</a></td></tr></table></td></tr></table>
<!--SRCH START-->
<DIV><TABLE CLASS="srch_mnpbgRt" WIDTH="163" BORDER="0" CELLPADDING="0" CELLSPACING="0">
<TR><TD>
<TABLE  WIDTH="163" BORDER="0" CELLPADDING="0" CELLSPACING="0" >
<FORM NAME="gsfxSearchRtform" ACTION="/search/default.aspx" METHOD="GET" ONSUBMIT="gsfxSearchRt_onsubmit();" TARGET="_top" >
<TR><TD>
<DIV CLASS="srch_mnpheaderRt">Search Support (KB)<BR>Windows Server 2003</DIV><input type=hidden name=InCC_hdn value=True><input type=hidden name=Catalog value=LCID=1033&CDID=EN-US-KB&PRODLISTSRC=ON><input type=hidden name=Product value=><input type=hidden name=KeywordType value=ALL><input type=hidden name=Titles value=false><input type=hidden name=numDays value=><input type=hidden name=maxResults value=25><TABLE BORDER="0" CELLSPACING="2" CELLPADDING="0" CLASS="SrchQueryRtOuterTable" ><TR><TD WIDTH="100%" VALIGN="TOP"><INPUT class="SrchQueryRtInput" TYPE="text" NAME="Queryl" MAXLENGTH="255" SIZE="16" value=""><INPUT TYPE="HIDDEN" NAME="Query"></INPUT></TD><TD WIDTH="24" VALIGN="TOP"><A HREF="Javascript:gsfxSearchRt_onsubmit();gsfxSearchRt_DoSubmit();" onmouseover="window.status='Run the search'; return true;" onmouseout="window.status='';return true;" ><IMG SRC="http://support.microsoft.com/library/images/support/goright.gif" WIDTH="24" BORDER="0" HSPACE="0" TITLE="Run the search" ALT="Run the search" ></A></TD>
</TR></TABLE>     <input type=hidden name="QuerySource" value="gsfxSearchRt_Query"></TD></TR><TR><TD>
<!-- SRCH FOOTER -->
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="2" WIDTH="163" CLASS="srch_mnpFtRt"><TR><TD><span CLASS="SrchOptionText" ><A TARGET="_top" id="advLinkRt" name="advLinkRt" HREF="http://support.microsoft.com/default.aspx?scid=FH;EN-US;KBHOWTO">Advanced Search and Help</A></span></TD></TR></TABLE><!-- SRCHFOOTER --><input type=hidden name=srchExtraQry value=></TD></TR>
</FORM></TABLE>
</TD></TR></TABLE></DIV>
<!-- SRCH END--><SCRIPT LANGUAGE="Javascript">

function gsfxSearchRt_onsubmit()
{
SubmitText(document.gsfxSearchRtform.Query,document.gsfxSearchRtform.Queryl,"gsfxSearchRt","Query","","","");}

function gsfxSearchRt_DoSubmit()
{ document.gsfxSearchRtform.submit(); }
AppendText(document.gsfxSearchRtform.Queryl,"gsfxSearchRt","Query","");

</SCRIPT>
<table cellspacing="0" cellpadding="0" border="0" id="SupportCenters" name="SupportCenters" class="ListNugget" width="165"><tr><td class="ListNuggetHeader">Support Centers</td></tr><tr><td id="SupportCentersBody" name="SupportCentersBody" class="ListNuggetBody" align="left">
<TABLE CELLSPACING="0" CELLPADDING="2" BORDER="0">
<TR><TD WIDTH="6" VALIGN="middle"><IMG SRC="http://support.microsoft.com/library/images/support/blue_bullet.gif" WIDTH="5" HEIGHT="5" BORDER="0" VALIGN="MIDDLE" HSPACE="0" ></TD>
<TD CLASS="ListNuggetItem" VALIGN="top">
	<A CLASS="ListNuggetItemLink" HREF="http://support.microsoft.com/default.aspx?scid=fh;EN-US;sbs">Small Business Server</A>
</TD></TR>
<TR><TD WIDTH="6" VALIGN="middle"><IMG SRC="http://support.microsoft.com/library/images/support/blue_bullet.gif" WIDTH="5" HEIGHT="5" BORDER="0" VALIGN="MIDDLE" HSPACE="0" ></TD>
<TD CLASS="ListNuggetItem" VALIGN="top">
	<A CLASS="ListNuggetItemLink" HREF="http://support.microsoft.com/default.aspx?scid=fh;EN-US;win2000">Windows 2000</A>
</TD></TR>
<TR><TD WIDTH="6" VALIGN="middle"><IMG SRC="http://support.microsoft.com/library/images/support/blue_bullet.gif" WIDTH="5" HEIGHT="5" BORDER="0" VALIGN="MIDDLE" HSPACE="0" ></TD>
<TD CLASS="ListNuggetItem" VALIGN="top">
	<A CLASS="ListNuggetItemLink" HREF="http://support.microsoft.com/default.aspx?scid=fh;EN-US;Win2000Dev">Windows 2000 - Developer</A>
</TD></TR>
<TR><TD WIDTH="6" VALIGN="middle"><IMG SRC="http://support.microsoft.com/library/images/support/blue_bullet.gif" WIDTH="5" HEIGHT="5" BORDER="0" VALIGN="MIDDLE" HSPACE="0" ></TD>
<TD CLASS="ListNuggetItem" VALIGN="top">
	<A CLASS="ListNuggetItemLink" HREF="http://support.microsoft.com/default.aspx?scid=fh;EN-US;winsvr2003">Windows Server 2003</A>
</TD></TR>
</TABLE><img src="http://support.microsoft.com/library/images/support/1ptrans.gif" height="6" width="100" border="0" /></td></tr></table><table cellspacing="0" cellpadding="0" border="0" id="GeneralInfo" name="GeneralInfo" class="ListNugget" width="165"><tr><td class="ListNuggetHeader">Other Support Options</td></tr><tr><td id="GeneralInfoBody" name="GeneralInfoBody" class="ListNuggetBody" align="left"><TABLE CELLSPACING="0" CELLPADDING="2" BORDER="0"><TR><TD WIDTH="6" VALIGN="top"><IMG SRC="http://support.microsoft.com/library/images/support/blue_bullet.gif" WIDTH="5" HEIGHT="5" BORDER="0" VALIGN="MIDDLE" VSPACE="4" HSPACE="0" ></TD><TD CLASS="ListNuggetItem" VALIGN="top"><A CLASS="ListNuggetItemLink" HREF="http://support.microsoft.com/default.aspx?scid=fh;EN-US;cntactms&amp;style=home" >Contact Microsoft</A><BR>Phone Numbers, Support Options and Pricing, Online Help, and more.</TD></TR><TR><TD WIDTH="6" VALIGN="top"><IMG SRC="http://support.microsoft.com/library/images/support/blue_bullet.gif" WIDTH="5" HEIGHT="5" BORDER="0" VALIGN="MIDDLE" VSPACE="4" HSPACE="0" ></TD><TD CLASS="ListNuggetItem" VALIGN="top"><A CLASS="ListNuggetItemLink" HREF="http://support.microsoft.com/default.aspx?scid=fh;EN-US;csshome&amp;style=home" >Customer Service</A><BR>For non-technical assistance with product purchases, subscriptions, online services, events, training courses, corporate sales, piracy issues, and more.</TD></TR><TR><TD WIDTH="6" VALIGN="top"><IMG SRC="http://support.microsoft.com/library/images/support/blue_bullet.gif" WIDTH="5" HEIGHT="5" BORDER="0" VALIGN="MIDDLE" VSPACE="4" HSPACE="0" ></TD><TD CLASS="ListNuggetItem" VALIGN="top"><A CLASS="ListNuggetItemLink" HREF="http://support.microsoft.com/newsgroups" >Newsgroups</A><BR>Pose a question to other users.  Discussion groups and Forums about specific Microsoft products, technologies, and services.</TD></TR></TABLE><img src="http://support.microsoft.com/library/images/support/1ptrans.gif" height="6" width="100" border="0" /></td></tr></table><table cellspacing="0" cellpadding="0" border="0" id="PageOptions" name="PageOptions" class="ListNugget" width="165"><tr><td class="ListNuggetHeader">Page Options</td></tr><tr><td id="PageOptionsBody" name="PageOptionsBody" class="ListNuggetBody" align="left"><TABLE CELLSPACING="0" CELLPADDING="2" BORDER="0"><TR><TD WIDTH="6" VALIGN="top"><A HREF="mailto:?body=http%3a%2f%2fsupport.microsoft.com%2fdefault.aspx%3fkbid%3d332199%26product%3dwinsvr2003" ><IMG SRC="http://support.microsoft.com/library/images/support/emailicon.gif" BORDER="0" HSPACE="0" Title="Send the contents of this page to a Friend" ></A></TD><TD CLASS="ListNuggetItem" VALIGN="top"><A CLASS="ListNuggetItemLink" HREF="mailto:?body=http%3a%2f%2fsupport.microsoft.com%2fdefault.aspx%3fkbid%3d332199%26product%3dwinsvr2003" >Send</A></TD></TR><TR><TD WIDTH="6" VALIGN="top"><A HREF="Javascript:PrintContents();" ><IMG SRC="http://support.microsoft.com/library/images/support/printicon.gif" BORDER="0" HSPACE="0" Title="Print the contents of this page" ></A></TD><TD CLASS="ListNuggetItem" VALIGN="top"><A CLASS="ListNuggetItemLink" HREF="Javascript:PrintContents();" >Print</A></TD></TR></TABLE><img src="http://support.microsoft.com/library/images/support/1ptrans.gif" height="6" width="100" border="0" /></td></tr></table></td></tr></table><!-- - - - - - - - - - - KB CONTENT BEGINS BELOW HERE - - - - - - - - - - --><H1 class="title">Using the DCPROMO /FORCEREMOVAL Command to Force the Demotion of Active Directory Domain Controllers</H1><a href="#appliesto">View products that this article applies to.</a><div class="notice">This article was previously published under Q332199 </div><div class="symptoms"><H2>SYMPTOMS</H2>Microsoft  Windows 2000 or Microsoft Windows Server 2003 domain controllers may not gracefully demote by using the Active Directory Installation Wizard (Dcpromo.exe). </div><div class="cause"><H2>CAUSE</H2>This behavior may occur if a required dependency or operation fails. These include network connectivity, name resolution, authentication, Active Directory directory service replication, or the location of a critical object in Active Directory. </div><div class="resolution"><H2>RESOLUTION</H2>To resolve this behavior, determine what is preventing the graceful demotion of the Windows 2000 or the Windows Server 2003 domain controller, and then try to demote the domain controller by using the Active Directory Installation Wizard again. </div><div class="workaround"><H2>WORKAROUND</H2>If you cannot resolve the behavior, you can use the following workarounds to perform a forced demotion of the domain controller to preserve the installation of the operating system and of any applications on it.<BR /><BR /><STRONG>Warning</STRONG> Before you use either of the following workarounds, make sure  that the user can successfully boot into Directory Services Restore mode. If not, the user will be unable to log on after forcefully demoting the computer. If the user does not remember the Directory Services Restore mode password, the user can reset the password by using the Setpwd.exe utility that is located in the Winnt\System32 folder. 

For additional information how to perform this procedure, click the following article number to view the article in the Microsoft Knowledge Base:

<p class="indent"><a class="KBlink" HREF="http://support.microsoft.com/default.aspx?kbid=271641">271641</a>

 The Configure Your Server Wizard Sets Blank Recovery Mode Password

</p><H3>Windows 2000 Domain Controllers</H3><OL class="dec"><LI>Install the Q332199 hotfix on a Windows 2000 domain controller that is running Service Pack 2 (SP2) or later, or install Windows 2000 Service Pack 4 (SP4). SP2 and later support forced demotion. Then, restart your computer.</LI><LI>Click <STRONG class="uiterm">Start</STRONG>, click <STRONG class="uiterm">Run</STRONG>, and then type the following command: <p class="indent"><KBD>dcpromo /forceremoval</KBD></p></LI><LI>Click <STRONG class="uiterm">OK</STRONG>.</LI><LI>At the <STRONG class="uiterm">Welcome to the Active Directory Installation Wizard</STRONG> page, click <STRONG class="uiterm">Next</STRONG>.</LI><LI>If the computer that you are removing is a global catalog server, click <STRONG class="uiterm">OK</STRONG> in the message window. <BR /><BR /><STRONG> Note</STRONG> Promote additional global catalogs in the forest or in the site if the domain controller that you are demoting is a global catalog server, as required.</LI><LI>At the <STRONG class="uiterm">Remove Active Directory</STRONG> page, make sure that the <STRONG class="uiterm">This server is the last domain controller in the domain</STRONG> check box is cleared, and then click <STRONG class="uiterm">Next</STRONG>.</LI><LI>At the <STRONG class="uiterm">Network Credentials</STRONG> page, type the name, password, and domain name for a user account with enterprise administrator credentials in the forest, and then click <STRONG class="uiterm">Next</STRONG>.</LI><LI>In <STRONG class="uiterm">Administrator Password</STRONG>, type the password and confirmed password that you want to assign to the Administrator account of the local SAM database, and then click <STRONG class="uiterm">Next</STRONG>.</LI><LI>On the <STRONG class="uiterm">Summary</STRONG> page, click <STRONG class="uiterm">Next</STRONG>.</LI><LI>Perform a metadata cleanup for the demoted domain controller on a surviving domain controller in the forest.<BR /><BR />
 If you removed a domain from the forest by using the <STRONG>remove selected domain</STRONG> command in Ntdsutil, verify that all the domain controllers and the global catalog servers in the forest have completely removed all the objects and the references to the domain that you just removed before you promote a new domain into the same forest with the same domain name. Tools such as Replmon.exe or Repadmin.exe from Windows 2000 Support Tools may help you determine if end-to-end replication has occurred. Windows 2000 SP3 and earlier global catalog servers are noticeably slower to remove objects and naming contexts than Windows Server 2003 is. </LI></OL><H3>Windows Server 2003 Domain Controllers</H3><OL class="dec"><LI>Windows Server 2003 domain controllers support forced demotion by default. Click <STRONG class="uiterm">Start</STRONG>, click <STRONG class="uiterm">Run</STRONG>, and then type the following command: <p class="indent"><KBD>dcpromo /forceremoval</KBD></p></LI><LI> Click <STRONG class="uiterm">OK</STRONG>.</LI><LI>At the <STRONG class="uiterm">Welcome to the Active Directory Installation Wizard</STRONG> page, click <STRONG class="uiterm">Next</STRONG>.</LI><LI>At the <STRONG class="uiterm">Force the Removal of Active Directory</STRONG> page, click <STRONG class="uiterm">Next</STRONG>.</LI><LI>In <STRONG class="uiterm">Administrator Password</STRONG>, type the password and confirmed password that you want to assign to the Administrator account of the local SAM database, and then click <STRONG class="uiterm">Next</STRONG>.</LI><LI>In <STRONG class="uiterm">Summary</STRONG>, click <STRONG class="uiterm">Next</STRONG>.</LI><LI>Perform a metadata cleanup for the demoted domain controller on a surviving domain controller in the forest.<BR /><BR />
 If you removed a domain from the forest by using the <STRONG>remove selected domain</STRONG> command in Ntdsutil, verify that all the domain controllers and the global catalog servers in the forest have completely removed all the objects and the references to the domain that you just removed before you promote a new domain into the same forest with the same domain name. Windows 2000 Service Pack 3 (SP3) and earlier global catalog servers are noticeably slower to remove objects and naming contexts than Windows Server 2003 is.</LI></OL> </div><div class="status"><H2>STATUS</H2> Microsoft has tested and supports the forced demotion of domain controllers that are running Windows 2000 or Windows Server 2003. </div><div class="moreinformation"><H2>MORE INFORMATION</H2> The Active Directory Installation Wizard creates Active Directory domain controllers on Windows 2000-based and Windows Server 2003-based computers. Operations that are performed by the Active Directory Installation Wizard include the installation of new services, changes to the startup values of existing services, and the transition to Active Directory as a security and authentication realm. <BR /><BR />
With forced demotion, a domain administrator can forcibly remove Active Directory and roll back locally held system changes without having to contact or replicate any locally held changes to another domain controller in the forest.<BR /><BR />
Because forced demotion results in the loss of any locally held changes, use it only as a last resort in production or test domains. You can forcibly demote domain controllers when connectivity, name resolution, authentication, or replication engine dependencies cannot be resolved so that graceful demotion can be performed. Valid scenarios for forced demotions include:  <UL><LI>There are no domain controllers currently available in the parent domain when you try to demote the last domain controller in an immediate child domain.</LI><LI>The Active Directory Installation Wizard cannot complete because there is a name resolution, authentication, replication engine, or Active Directory object dependency that you cannot resolve after you perform detailed troubleshooting.</LI><LI>A domain controller has not replicated inbound Active Directory changes in Tombstone Lifetime (Default Tombstone Lifetime is 60 days) number of days for one or more naming contexts. <BR /><BR /><STRONG>Important</STRONG> Do not recover such domain controllers unless they are the only chance of recovery for a particular domain.</LI><LI>Time does not permit more detailed troubleshooting because you must immediately bring into service the domain controller.</LI></UL>
 Forced demotions may be useful in lab and classroom environments where you can remove domain controllers out of existing domains, yet you do not have to demote each domain controller serially. <BR /><BR />
 If you force the demotion of a domain controller, you will lose any unique changes that reside in the Active Directory of the domain controller that you are forcibly demoting, including the addition, deletion, or modification of users, computers, groups, trust relationships, and Group Policy or Active Directory configuration that did not replicate off before you ran the <STRONG>dcpromo /forceremoval</STRONG> command. Additionally, you will lose changes to any of the attributes on these objects, such as passwords for users, computers, and trust relationships and group membership.<BR /><BR />
However, if you force the demotion of a domain controller, you return the operating system to a state that is the same as the successful demotion of the last domain controller in a domain (service start values, installed services, use of a registry based SAM for the account database, computer is a member of a workgroup). Programs that are installed on the demoted domain controller remain installed.<BR /><BR />
The System event log identifies forcibly demoted Windows 2000 domain controllers (and instances of the <STRONG>dcpromo /forceremoval</STRONG> operation) by event ID 29234. For example:<P class="indent">
 Event Type: WARNING<BR />
Event Source: lsasrv<BR />
 Event Category: None <BR />
 Event ID: 29234<BR />
 Date: MM/DD/YYYY<BR />
 Time: HH:MM:SS AM|PM<BR />
 User: N/A<BR />
 Computer: <VAR>computername</VAR> Description: The server was force demoted. It is no longer a Domain controller. </P>The System event log identifies forcibly demoted Windows Server 2003 domain controllers by event ID 29239. For example:<P class="indent">Event Type: WARNING<BR />
Event Source: lsasrv<BR />
 Event Category: None<BR />
 Event ID: 29239<BR />
 Date: MM/DD/YYYY<BR />
 Time: HH:MM:SS AM|PM<BR />
 User: N/A<BR />
 Computer: <VAR>computername</VAR> Description: The server was force demoted. It is no longer a Domain controller. </P>After you use the <STRONG>dcpromo /forceremoval</STRONG> command, metadata for the demoted computer is <EM>not </EM>deleted on surviving domain controllers.   For  additional information, click the following article number to view the article  in the Microsoft Knowledge Base: <p class="indent"><a class="KBlink" HREF="http://support.microsoft.com/default.aspx?scid=kb;EN-US;216498">216498</a>
 HOW TO: Remove Data in Active Directory After an Unsuccessful Domain Controller Demotion
</p>The following are items that you must address, if applicable, after forcibly demoting a domain controller:  <OL class="dec"><LI>Remove the computer account from the domain.</LI><LI>Verify that DNS records, including A, CNAME, and SRV Records, are removed, and remove them if they are present.</LI><LI>Verify that  FRS member objects (FRS and DFS) are removed, and remove them if they are present. For additional information, click the following article number to view the article in the Microsoft Knowledge Base: <p class="indent"><a class="KBlink" HREF="http://support.microsoft.com/default.aspx?scid=kb;EN-US;296183">296183</a>
 Overview of Active Directory Objects That Are Used by FRS
</p></LI><LI> If the demoted computer is a member of any security groups, remove it from those groups.</LI><LI>Remove any DFS references to the demoted server (links or root replicas). </LI><LI>A surviving domain controller must seize any operations master roles (also known as flexible single master operations or FSMO) that were previously held by the forcibly demoted domain controller. For additional information, click the following article number to view the article in the Microsoft Knowledge Base: <p class="indent"><a class="KBlink" HREF="http://support.microsoft.com/default.aspx?scid=kb;EN-US;255504">255504</a>
 Using Ntdsutil.exe to Seize or Transfer FSMO Roles to a Domain Controller
</p></LI><LI>If the domain controller that you are demoting is a DNS Server or Global Catalog server, you must create a new GC or DNS Server to satisfy load balancing, fault tolerance, and configuration settings in the forest. 
</LI><LI>When you use the <STRONG>remove selected server</STRONG> command in NTDSUTIL, the NTDSDSA object (the parent object for inbound connections to the domain controller that you forcibly demoted) is removed. The command does not remove the parent server objects that appear in the Sites and Services snap-in. Use the Active Directory Sites and Services MMC snap-in to remove the server object if the domain controller will not be promoted into the forest with the same computer name.</LI></OL> </div><div name="appliesto" id="appliesto" class="appliesto"><H3>The information in this article applies to:</H3><UL><LI>Microsoft Windows Server 2003, 64-Bit Datacenter Edition</LI><LI>Microsoft Windows Server 2003, 64-Bit Enterprise Edition</LI><LI>Microsoft Windows Server 2003, Datacenter Edition</LI><LI>Microsoft Windows Server 2003, Enterprise Edition</LI><LI>Microsoft Windows Server 2003, Standard Edition</LI><LI>Microsoft Windows 2000 Server</LI><LI>Microsoft Windows 2000 Advanced Server</LI><LI>Microsoft Windows 2000 Datacenter Server</LI></UL></div><TABLE class="docinfo" cellspacing="1" cellpadding="3" align="center"><TR><TD align="right" width="5%" class="label" valign="top" nowrap="1">Last Reviewed:</TD><TD align="left" class="data" valign="top">10/31/2003
			 (5.0)
		</TD></TR><TR class="composite"><TD align="right" width="5%" class="label" valign="top" nowrap="1">Keywords:</TD><TD align="left" class="data" valign="top">kbbug KB332199</TD></TR></TABLE><BR /><div class="disclaimer"></div><!-- - - - - - - - - - - - PAGE TEXT ENDS ABOVE HERE - - - - - - - - - - - --></td></tr><tr><td align="center"><table class="GetHelpHori" ><tr><td valign="middle"><a href="http://support.microsoft.com/default.aspx?scid=sz;EN-US;top&product=winsvr2003&prname=Windows%20Server%202003"><IMG src="http://support.microsoft.com/library/images/support/Get_Help_sml.gif" align="center" border="0" vspace="3" hspace="0" alt="Need More Help?" title="Need More Help?" /></a></td><td><table><tr><td align="left" class="GetHelpTitle" valign="top">Need More Help?</td></tr><tr><td align="left" valign="middle" class="GetHelpText"><a href="http://support.microsoft.com/default.aspx?scid=sz;EN-US;top&product=winsvr2003&prname=Windows%20Server%202003">Contact a Support Professional by E-Mail, Online or Phone</a></td></tr></table></td></tr></table></td></tr></table></div></div>
<script>d.gsfxSearchRtform.srchExtraQry.value ='Windows Server 2003';
 ChangeLink('winsvr2003')</script>

</DIV>

</DIV>
</XMLREADER></td></tr></table></td></tr><tr><td valign="top" class="tpl_footer"><table class="tpl_footer_row1"><tr><td class="fbtn_cell">&nbsp;<A HREF="http://support.microsoft.com/default.aspx?pr=cntactms&style=home" TARGET="_top" >Contact Us</A>&nbsp;</td></tr></table><BR><div class="tpl_footer_row2">© 2004 Microsoft Corporation. All rights reserved.&nbsp;&nbsp;<A HREF="http://support.microsoft.com/default.aspx?scid=%2fsupport%2fmisc%2fcpyright.asp" TARGET="http://support.microsoft.com/default.aspx?scid=%2fsupport%2fmisc%2fcpyright.asp" class="ftr_copyright_text">Terms of use</A>&nbsp;&nbsp;<A HREF="http://www.microsoft.com/security/default.asp" TARGET="http://www.microsoft.com/security/default.asp" class="ftr_copyright_text">Security & Privacy</A>&nbsp;&nbsp;<A HREF="http://support.microsoft.com/default.aspx?scid=%2fisapi%2fgomscom.asp%3ftarget%3d%2fenable%2fdefault.htm" TARGET="http://support.microsoft.com/default.aspx?scid=%2fisapi%2fgomscom.asp%3ftarget%3d%2fenable%2fdefault.htm" class="ftr_copyright_text">Accessibility</A>&nbsp;&nbsp;</div></td></tr></table><IMG style="display:none;" name="metrixgif" SRC="/library/images/support/1ptrans.gif"></BODY>

<script language="JavaScript" >
   function thisLoad(){
setcookieval("SITE","GN");

   g_reSupportedHostnames = new RegExp(".msn.com$|.passport.com$|.xbox.com$|.microsoft.com$|.microsoft.cz$|.msbpn.com$|.microsoft.co.*", "i");
  ForeignLink_Hookup(true);LogHit('http://c.microsoft.com/trans_pixel.asp?TYPE=SSPV&SOURCE=SUPPORT&URI=/GN/EN-US/kb_en-us_332199&GUID=1F4FC18C-F71E-47fb-8FC9-612F8EE59C61&R=');
   }

function thisUnload(){
;   }
</script>
</HTML>